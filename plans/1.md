# Implementation Plan: Lair Dramatic Presentation Scorer

## Overview

This plan describes the implementation of a scalar function that evaluates the theatrical and aesthetic potential of a location as a villain's lair. The function returns a score from 0 (mundane) to 1 (magnificently theatrical) based on four equally-weighted dimensions: Architectural Grandeur, Atmospheric Quality, Symbolic Resonance, and Monologue Backdrop Quality.

---

## Input Schema Structure

### Schema Definition

```json
{
  "type": "object",
  "description": "Input for evaluating a location's theatrical potential as a villain's lair",
  "properties": {
    "location": {
      "anyOf": [
        {
          "type": "string",
          "description": "A text description of the location (from brief phrase to detailed architectural description)"
        },
        {
          "type": "image",
          "description": "A photograph, rendering, or artistic depiction of the location"
        },
        {
          "type": "video",
          "description": "Moving footage capturing the location's atmosphere, weather, lighting, and spatial relationships"
        }
      ]
    },
    "villain_profile": {
      "type": "string",
      "description": "Optional description of the villain's aesthetic preferences, power source, era affinity, and desired emotional register. When provided, evaluation is calibrated to this specific villain type."
    }
  },
  "required": ["location"]
}
```

### Field Descriptions

1. **location** (required): The primary input representing the potential lair site
   - Text: Can range from brief ("abandoned Victorian asylum on a cliff") to extensive architectural details
   - Image: Photographs, concept art, architectural renderings, film stills
   - Video: Atmospheric footage, virtual tours, cinematic reveals

2. **villain_profile** (optional): Calibrates the evaluation to specific villain aesthetics
   - Examples: "cold techno-futurist bent on digital domination", "ancient vampire lord with Gothic sensibilities", "eco-terrorist seeking harmony with nature"
   - When absent, evaluation uses a general "theatrical villainy" standard

---

## Input Maps

**No input maps are needed for this function.**

The function evaluates a single location against all criteria. All 17 tasks evaluate the same `location` input with optional consideration of `villain_profile`. There is no need for mapped execution over arrays of items.

---

## Function Definition Structure

```json
{
  "type": "scalar.function",
  "description": "Evaluate the theatrical and aesthetic potential of a location as a villain's lair. Assesses Architectural Grandeur, Atmospheric Quality, Symbolic Resonance, and Monologue Backdrop Quality. Returns a score from 0 (mundane) to 1 (magnificently theatrical).",
  "input_schema": { ... },
  "tasks": [
    // 16 dimensional tasks (4 per dimension)
    // 1 holistic integration task
    // Total: 17 tasks
  ]
}
```

---

## Task Definitions

### Dimension 1: Architectural Grandeur (4 tasks)

#### Task 1.1: Scale and Intimidation
- **Type**: `vector.completion`
- **System prompt**: Expert in architectural psychology and spatial intimidation. Evaluate whether structures create overwhelming scale that makes humans feel appropriately small.
- **User content**: Combines location input with evaluation prompt for scale assessment
- **Responses** (5-point scale):
  1. "Overwhelming scale: Structures create profound sense of human insignificance; architecture actively intimidates"
  2. "Impressive scale: Notable grandeur that commands respect; visitor feels appropriately diminished"
  3. "Moderate scale: Some imposing elements present but not consistently overwhelming"
  4. "Unremarkable scale: Standard proportions; nothing makes visitors feel small"
  5. "Diminutive scale: Structures are actively cozy, welcoming, or cramped; anti-intimidating"
- **Output**: Weighted sum: `scores[0]*1.0 + scores[1]*0.75 + scores[2]*0.5 + scores[3]*0.25 + scores[4]*0.0`

#### Task 1.2: Natural Feature Integration
- **Type**: `vector.completion`
- **System prompt**: Expert in environmental architecture. Evaluate how the location merges with dramatic natural features.
- **Responses** (5-point scale):
  1. "Masterful integration: Location and natural feature are inseparable; the lair seems to have grown from the landscape"
  2. "Strong integration: Dramatic natural features are incorporated into the location's identity"
  3. "Moderate integration: Some natural drama present but not fully exploited or merged"
  4. "Minimal integration: Natural environment exists nearby but is essentially separate from the location"
  5. "No integration: Location ignores or actively conflicts with its natural surroundings"
- **Output**: Weighted sum as above

#### Task 1.3: Ceremonial Space Potential
- **Type**: `vector.completion`
- **System prompt**: Expert in ceremonial architecture and power staging. Evaluate capacity for throne rooms, command centers, audience chambers.
- **Responses** (5-point scale):
  1. "Exceptional ceremonial potential: Multiple spaces perfectly suited for all villainous ceremonial needs"
  2. "Strong ceremonial potential: Clear spaces for most ceremonial functions; only minor adaptation needed"
  3. "Moderate ceremonial potential: Some ceremonial uses possible with effort; core spaces exist"
  4. "Limited ceremonial potential: Would require significant construction to support ceremonial functions"
  5. "No ceremonial potential: Actively hostile to ceremonial use; no appropriate spaces imaginable"
- **Output**: Weighted sum as above

#### Task 1.4: Visual Dominance and Silhouette
- **Type**: `vector.completion`
- **System prompt**: Expert in visual composition and iconic architecture. Evaluate whether location commands visual attention with distinctive, memorable profile.
- **Responses** (5-point scale):
  1. "Iconic dominance: Unmistakable silhouette that could become legendary; commands the landscape absolutely"
  2. "Strong dominance: Clearly the visual focus of its environment; memorable profile"
  3. "Moderate dominance: Noticeable but not commanding; competes with surroundings"
  4. "Weak dominance: Blends with environment; requires proximity to appreciate"
  5. "No dominance: Invisible, hidden, or visually subordinate to surroundings"
- **Output**: Weighted sum as above

---

### Dimension 2: Atmospheric Quality (4 tasks)

#### Task 2.1: Natural Mood Enhancement
- **Type**: `vector.completion`
- **System prompt**: Expert in environmental atmosphere and climate drama. Evaluate inherent atmospheric drama from weather, climate, and environmental conditions.
- **Responses** (5-point scale):
  1. "Perpetually dramatic: Environment provides constant, unavoidable atmospheric intensity"
  2. "Frequently dramatic: Regular occurrence of mood-enhancing conditions; reliable atmosphere"
  3. "Occasionally dramatic: Some atmospheric events possible but not consistent"
  4. "Rarely dramatic: Mild, stable conditions; occasional minor weather interest"
  5. "Aggressively pleasant: Sunshine, gentle breezes, comfortable temperatures; anti-atmospheric"
- **Output**: Weighted sum as above

#### Task 2.2: Lighting Potential
- **Type**: `vector.completion`
- **System prompt**: Expert in theatrical lighting and dramatic cinematography. Evaluate potential for shadows, backlighting, and dramatic reveals.
- **Responses** (5-point scale):
  1. "Masterful lighting potential: Multiple sources for backlighting, shadow, and dramatic reveal; complete control possible"
  2. "Strong lighting potential: Excellent opportunities for theatrical lighting; natural drama present"
  3. "Moderate lighting potential: Some lighting options available; reasonable shadow capability"
  4. "Limited lighting potential: Few natural sources of drama; artificial lighting would be primary"
  5. "Poor lighting potential: Uniformly lit, no shadow depth, no backlighting opportunities; fluorescent office quality"
- **Output**: Weighted sum as above

#### Task 2.3: Acoustic Properties
- **Type**: `vector.completion`
- **System prompt**: Expert in architectural acoustics and environmental soundscapes. Evaluate echo, reverberation, and natural sounds for villainous vocalization.
- **Responses** (5-point scale):
  1. "Exceptional acoustics: Perfect for all villainous vocalization; natural soundscape enhances drama; sounds carry magnificently"
  2. "Strong acoustics: Good reverberation, atmospheric sounds, reasonable range"
  3. "Moderate acoustics: Some acoustic interest; echoes or natural sounds present"
  4. "Limited acoustics: Acoustically flat; no natural soundscape; voice doesn't carry"
  5. "Poor acoustics: Muffled, dead, or actively unpleasant sounds; destroys vocal drama"
- **Output**: Weighted sum as above

#### Task 2.4: Atmospheric Effects Potential
- **Type**: `vector.completion`
- **System prompt**: Expert in environmental effects and atmospheric staging. Evaluate capacity for fog, mist, lightning, steam, and other dramatic effects.
- **Responses** (5-point scale):
  1. "Natural effects paradise: Multiple atmospheric effects occur naturally and regularly"
  2. "Strong effects potential: Easy to achieve multiple effects; some occur naturally"
  3. "Moderate effects potential: Some effects possible with effort; occasional natural occurrence"
  4. "Limited effects potential: Difficult to achieve; stable, resistant environment"
  5. "Effects-hostile: Conditions actively prevent fog, mist, or other atmospheric enhancement"
- **Output**: Weighted sum as above

---

### Dimension 3: Symbolic Resonance (4 tasks)

#### Task 3.1: Historical and Power Associations
- **Type**: `vector.completion`
- **System prompt**: Expert in location history and power symbolism. Evaluate historical weight from associations with power, tragedy, mystery, or transgression.
- **Responses** (5-point scale):
  1. "Profoundly weighted: Rich historical associations with power, tragedy, and mystery; location carries palpable history"
  2. "Strongly weighted: Clear historical significance; notable events occurred here"
  3. "Moderately weighted: Some historical interest; minor associations with power or drama"
  4. "Lightly weighted: Minimal history; location is essentially a blank slate"
  5. "Historically void: Aggressively new, ahistorical, or actively cheerful history"
- **Output**: Weighted sum as above

#### Task 3.2: Mythological and Archetypal Significance
- **Type**: `vector.completion`
- **System prompt**: Expert in cultural mythology and architectural archetypes. Evaluate how location taps into universal symbols of power and menace.
- **Responses** (5-point scale):
  1. "Archetypal perfection: Location embodies multiple universal symbols; feels mythologically inevitable"
  2. "Strong archetypal resonance: Clear participation in cultural mythology; recognizable symbolic weight"
  3. "Moderate resonance: Some mythological elements present; partial archetypal qualities"
  4. "Weak resonance: Minimal symbolic dimension; requires explanation rather than evoking feeling"
  5. "Archetypal void: Contradicts or ignores mythological vocabulary; symbolically meaningless"
- **Output**: Weighted sum as above

#### Task 3.3: Ironic and Subversive Potential
- **Type**: `vector.completion`
- **System prompt**: Expert in horror through contrast and subversive settings. Evaluate ironic potential from contrast between innocent appearance and sinister purpose.
- **Responses** (5-point scale):
  1. "Masterful ironic potential: Extreme contrast between appearance and possible dark purpose; deeply unsettling subversion"
  2. "Strong ironic potential: Clear opportunity for disturbing contrast; villain would seem more menacing through irony"
  3. "Moderate ironic potential: Some ironic dimension possible; contrast could enhance menace"
  4. "Limited ironic potential: Little contrast available; location is what it appears to be"
  5. "No ironic potential: Already dark or sinister; no innocence to subvert"
- **Output**: Weighted sum as above

#### Task 3.4: Iconic Memorability
- **Type**: `vector.completion`
- **System prompt**: Expert in iconic imagery and visual branding. Evaluate whether location is visually and conceptually memorable, an image that persists in dreams.
- **Responses** (5-point scale):
  1. "Legendary memorability: Instantly iconic; would become cultural reference; haunts the imagination"
  2. "Strong memorability: Highly distinctive; easily remembered and recognized; striking"
  3. "Moderate memorability: Notable but not extraordinary; would be remembered in context"
  4. "Weak memorability: Forgettable; blends with similar locations; generic"
  5. "Unmemorable: Actively bland; impossible to recall; architectural amnesia"
- **Output**: Weighted sum as above

---

### Dimension 4: Monologue Backdrop Quality (4 tasks)

#### Task 4.1: Dramatic Gesture Views
- **Type**: `vector.completion`
- **System prompt**: Expert in theatrical staging and villain presentation. Evaluate views and vistas appropriate for dramatic gestures during monologues.
- **Responses** (5-point scale):
  1. "Perfect gesture support: Multiple views for every monologue type; villain can move dramatically through space"
  2. "Strong gesture support: Clear views for dramatic gesturing; most monologue types supported"
  3. "Moderate gesture support: Some appropriate views available; workable for core monologue needs"
  4. "Limited gesture support: Few dramatic views; villain would be visually constrained"
  5. "No gesture support: No views, no vistas, no sightlines; gesturing toward walls"
- **Output**: Weighted sum as above

#### Task 4.2: Human Figure Scale and Framing
- **Type**: `vector.completion`
- **System prompt**: Expert in cinematographic framing and theatrical staging. Evaluate how location frames human figures for dominance, titan imagery, and theatrical visibility.
- **Responses** (5-point scale):
  1. "Masterful framing: Complete range of scales available; villain can choose framing for any moment"
  2. "Strong framing: Multiple framing options; good theatrical staging potential"
  3. "Moderate framing: Some framing options present; could stage effectively with effort"
  4. "Limited framing: Few framing options; villain locked into one scale relationship"
  5. "Poor framing: Actively unflattering or visually confusing framing; villain diminished"
- **Output**: Weighted sum as above

#### Task 4.3: Environmental Punctuation and Dramatic Beats
- **Type**: `vector.completion`
- **System prompt**: Expert in environmental storytelling and theatrical rhythm. Evaluate natural pauses, punctuation, and dramatic beats to support monologue rhythm.
- **Responses** (5-point scale):
  1. "Perfect environmental rhythm: Multiple punctuation options; environment seems designed for speeches"
  2. "Strong rhythmic support: Clear opportunities for emphasis and revelation; natural beats present"
  3. "Moderate rhythmic support: Some punctuation available; occasional environmental emphasis possible"
  4. "Limited rhythmic support: Few natural pauses or emphases; static environment"
  5. "No rhythmic support: Dead environment; no punctuation; monologue unsupported"
- **Output**: Weighted sum as above

#### Task 4.4: Backlighting and Silhouette Potential
- **Type**: `vector.completion`
- **System prompt**: Expert in dramatic silhouette and villain iconography. Evaluate capacity to backlight the villain for iconic silhouette moments.
- **Responses** (5-point scale):
  1. "Iconic silhouette potential: Multiple backlighting sources; villain could achieve legendary silhouette"
  2. "Strong silhouette potential: Clear backlighting opportunities; dramatic silhouette achievable"
  3. "Moderate silhouette potential: Some backlighting possible; silhouette with effort"
  4. "Limited silhouette potential: Few backlighting options; weak silhouette capability"
  5. "No silhouette potential: No backlighting sources; villain always fully visible or invisible"
- **Output**: Weighted sum as above

---

### Holistic Integration Task

#### Task 5.1: Overall Theatrical Villainy Assessment
- **Type**: `vector.completion`
- **System prompt**: Master expert in villain lair aesthetics. Provide holistic evaluation considering all dimensions working together.
- **Responses** (5-point scale):
  1. "Legendary lair: Location itself is already halfway to villainy; would make any occupant seem magnificent"
  2. "Excellent lair: Strong in all dimensions; would significantly elevate villainous presentation"
  3. "Competent lair: Solid theatrical potential; serves a capable villain well"
  4. "Marginal lair: Some potential present but requires significant imagination or modification"
  5. "Unsuitable: Actively undermines villainy; mundane, cheerful, or contextually inappropriate"
- **Output**: Weighted sum as above

---

## Expressions

### Task Output Expressions

All 17 tasks use the same weighted sum expression for 5-point scales:

```starlark
output['scores'][0] * 1.0 + output['scores'][1] * 0.75 + output['scores'][2] * 0.5 + output['scores'][3] * 0.25 + output['scores'][4] * 0.0
```

### User Content Expressions

Each task constructs user content dynamically:

```starlark
# For tasks that incorporate villain_profile when present:
'Evaluate the [CRITERION] of this location' + ((' for a villain with the following profile: ' + input['villain_profile']) if 'villain_profile' in input and input['villain_profile'] else '') + ':\n\n' + str(input['location'])
```

Or using array-based content construction for multimodal inputs:

```json
{
  "type": "text",
  "text": "Evaluate the [CRITERION] of this location:"
},
{
  "type": "text", 
  "text": { "$starlark": "input['location']" }
}
```

### Villain Profile Integration

For optional villain_profile, system prompts can include conditional guidance:

```starlark
# Base system prompt + optional profile consideration
"You are an expert in [domain]. " + ("Consider specifically how well this location serves a villain described as: " + input.get('villain_profile', '') + ". " if input.get('villain_profile') else "") + "Evaluate [criterion]..."
```

---

## Test Inputs

### Edge Cases and Diverse Scenarios

#### 1. Legendary Lair (Expected: 0.85-1.0)
```json
{
  "location": "A massive obsidian fortress carved into the caldera of an active volcano on a remote Pacific island. The main throne room overlooks the bubbling lava lake through floor-to-ceiling windows of heat-resistant crystal. Perpetual volcanic lightning storms illuminate the towering spires, each topped with Tesla coils that harvest the atmospheric electricity. The approach requires crossing a narrow bridge suspended over the magma, with the fortress silhouette visible from twenty miles away—a jagged crown of black stone against the perpetually glowing sky."
}
```

#### 2. Classic Gothic (Expected: 0.75-0.90)
```json
{
  "location": "A crumbling Transylvanian castle perched on a cliff above a perpetually fog-shrouded valley. The castle features soaring Gothic spires, gargoyles on every parapet, and a great hall with vaulted ceilings where every footstep echoes. Lightning storms are frequent, and the castle's position catches every one. The approach winds up a narrow mountain road through dead forest, with the castle appearing and disappearing in the mist."
}
```

#### 3. Tech Villain Lair (Expected: 0.70-0.85)
```json
{
  "location": "A stark white modernist compound built into an Antarctic glacier. The main control room features a 360-degree wall of screens showing global data feeds, with the villain's chair elevated in the center. Outside, endless white wasteland under aurora australis. The compound is invisible until you're within a mile—then it emerges from the ice like a cold geometric dream. Internal spaces are precise, clinical, with dramatic strip lighting.",
  "villain_profile": "A techno-futurist AI researcher who believes human emotion is obsolete. Cold, clinical aesthetic. Values precision, surveillance, and the elimination of chaos."
}
```

#### 4. Subversive/Ironic Location (Expected: 0.50-0.70)
```json
{
  "location": "An abandoned 1950s amusement park, its cheerful painted facades now faded and peeling. The central castle from the fairy tale section still stands, its turrets visible above rusting roller coaster tracks. The fun house mirrors still work, creating a maze of distorted reflections. At night, some of the old lights still flicker on randomly. The carousel plays its tune, off-key, when the wind catches it right."
}
```

#### 5. Industrial Horror (Expected: 0.55-0.75)
```json
{
  "location": "A massive abandoned steel mill in the rust belt. The blast furnaces still stand like iron cathedrals, their interiors cavernous and echoing. Catwalks crisscross at dizzying heights. The control room overlooks the main floor from behind shattered windows. Steam vents still occasionally release pressure with a hellish hiss. At sunset, the rusted metal glows orange like cooling metal."
}
```

#### 6. Underwater Lair (Expected: 0.70-0.85)
```json
{
  "location": "A research station converted to private fortress at the bottom of the Mariana Trench. The main observation dome provides views of bioluminescent creatures in the eternal darkness. Pressure-resistant corridors connect modular chambers, each with its own dramatic lighting. The command center features a holographic globe showing the surface world—so far above, so vulnerable. The only approach is by personal submarine through an underwater canyon filled with thermal vents."
}
```

#### 7. Mundane Location (Expected: 0.05-0.20)
```json
{
  "location": "A well-lit modern office building in a suburban business park. The space features drop ceilings, fluorescent lighting, beige carpeting, and a small break room with a coffee maker. Large windows overlook a parking lot and some nicely maintained landscaping. The HVAC system provides consistent 72-degree temperature year-round."
}
```

#### 8. Anti-Lair (Expected: 0.0-0.15)
```json
{
  "location": "A sunny daycare center decorated with cheerful rainbows and cartoon animals. Small plastic chairs surround tiny tables. The play area features soft foam flooring and age-appropriate toys. Large windows let in abundant natural light. A small garden outside has tomato plants the children tend. The building is single-story with low ceilings and a welcoming reception area."
}
```

#### 9. Religious/Mystical (Expected: 0.65-0.85)
```json
{
  "location": "An abandoned monastery built into the side of a Himalayan peak, accessible only by a rope bridge across a thousand-foot chasm. The temple contains a vast underground chamber carved from the mountain itself, where ancient frescoes depict apocalyptic scenes by torchlight. The wind through the narrow windows creates a constant mournful howl. At certain times of year, the sun aligns perfectly with the central altar."
}
```

#### 10. Space Station (Expected: 0.75-0.90)
```json
{
  "location": "An orbital command station in geostationary orbit above Earth. The main observation deck provides a God's-eye view of the planet below—every continent visible, every city a cluster of lights at night. The command throne faces this view, with holographic displays flanking the figure who sits there. The station's silhouette is distinctive: a central spire surrounded by rotating rings, visible from Earth as a bright point of light.",
  "villain_profile": "A former space agency director who believes Earth's governments have proven themselves unworthy of managing the planet. Seeks to establish a new world order from above. Values the cosmic perspective, control, and the long view."
}
```

#### 11. Minimal Text Description (Expected: Variable)
```json
{
  "location": "An old lighthouse on a rocky coast"
}
```

#### 12. Profile Mismatch Test (Expected: Lower score due to mismatch)
```json
{
  "location": "A brutalist concrete bunker buried beneath a desert, with harsh fluorescent lighting and sterile metal corridors. The command center is a cube of gray walls covered in analog dials and switches.",
  "villain_profile": "A romantic vampire count who values Gothic elegance, candlelight, and the sensual pleasure of beautiful decay. Seeks eternal night and the restoration of aristocratic rule."
}
```

---

## Scoring Aggregation

The final score is calculated as the average of the four dimensional scores:

```
D1 = (Task1.1 + Task1.2 + Task1.3 + Task1.4) / 4  // Architectural Grandeur
D2 = (Task2.1 + Task2.2 + Task2.3 + Task2.4) / 4  // Atmospheric Quality
D3 = (Task3.1 + Task3.2 + Task3.3 + Task3.4) / 4  // Symbolic Resonance
D4 = (Task4.1 + Task4.2 + Task4.3 + Task4.4) / 4  // Monologue Backdrop Quality

Final Score = (D1 + D2 + D3 + D4) / 4
```

The holistic task (5.1) serves as a calibration reference and may be used for quality assurance or edge case adjustment, but the primary score derives from the dimensional averages.

---

## Implementation Notes

1. **Multimodal Handling**: The location input uses `anyOf` to accept string, image, or video. User content construction must handle all three types appropriately.

2. **Optional Profile**: When `villain_profile` is absent, evaluations use general theatrical villainy standards. When present, prompts should incorporate profile-specific considerations.

3. **Binary vs. Multi-Response**: Using 5-point response scales (like joke-relatability-scorer) rather than binary (like joke-timing-scorer) provides more nuanced scoring.

4. **Consistent Weighting**: All dimensions and all tasks within dimensions are equally weighted, maintaining the 25% per dimension structure from the essay.

5. **Task Independence**: Each task evaluates one specific quality independently, then scores are aggregated. This prevents early tasks from biasing later ones.
